package main

import (
  "github.com/baruchlubinsky/plotly"
  "fmt"
  "strings"
)

// This program creates a plot on plotly, retrieves it, and saves it as an image.
func main () {
  request := plotly.NewRequest()
  request.Origin = "plot"
  request.Args = `[{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[11,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"0","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10],"y":[11,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"10","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20],"y":[11,22,27,33,36,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"20","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30],"y":[11,16,21,25,26,27,31,33,38,40,40,40,40,40,40,40,40,40,40,40],"name":"30","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"y":[0,19,24,27,31,33,36,38,40,40,40,40,40,40,40,40,40,40,40,40],"name":"40","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50],"y":[0,29,34,37,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"50","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60],"y":[11,25,30,35,37,37,39,39,40,40,40,40,40,40,40,40,40,40,40,40],"name":"60","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70],"y":[0,18,24,32,35,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"70","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80],"y":[11,29,36,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"80","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90],"y":[0,17,21,28,34,37,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"90","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100],"y":[0,29,36,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"100","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110],"y":[0,30,37,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"110","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120,120],"y":[0,14,17,21,24,27,31,35,39,40,40,40,40,40,40,40,40,40,40,40],"name":"120","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130,130],"y":[0,12,16,21,24,28,33,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"130","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140,140],"y":[0,29,35,38,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"140","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150,150],"y":[0,18,22,25,26,28,31,35,40,40,40,40,40,40,40,40,40,40,40,40],"name":"150","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160,160],"y":[0,33,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"160","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170],"y":[0,26,32,35,37,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"170","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180,180],"y":[0,16,21,24,26,27,28,31,35,37,39,40,40,40,40,40,40,40,40,40],"name":"180","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[190,190,190,190,190,190,190,190,190,190,190,190,190,190,190,190,190,190,190,190],"y":[0,30,35,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"190","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200],"y":[0,26,33,35,38,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"200","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210,210],"y":[0,27,35,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"210","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[220,220,220,220,220,220,220,220,220,220,220,220,220,220,220,220,220,220,220,220],"y":[0,20,24,31,37,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"220","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230,230],"y":[0,20,23,28,31,34,36,39,40,40,40,40,40,40,40,40,40,40,40,40],"name":"230","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240],"y":[0,14,18,23,30,35,38,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"240","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250,250],"y":[11,22,27,32,35,37,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"250","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260,260],"y":[0,28,34,37,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40],"name":"260","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270,270],"y":[10,18,22,23,26,30,34,37,39,40,40,40,40,40,40,40,40,40,40,40],"name":"270","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280],"y":[10,21,26,30,32,35,37,39,40,40,40,40,40,40,40,40,40,40,40,40],"name":"280","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290,290],"y":[10,12,15,18,23,27,32,35,38,40,40,40,40,40,40,40,40,40,40,40],"name":"290","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300,300],"y":[10,16,19,26,29,33,36,38,40,40,40,40,40,40,40,40,40,40,40,40],"name":"300","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310,310],"y":[10,20,24,27,30,33,34,35,37,39,40,40,40,40,40,40,40,40,40,40],"name":"310","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[320,320,320,320,320,320,320,320,320,320,320,320,320,320,320,320,320,320,320,320],"y":[10,17,21,24,26,28,30,32,34,36,38,40,40,40,40,40,40,40,40,40],"name":"320","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330],"y":[10,20,24,26,28,31,33,35,37,39,40,40,40,40,40,40,40,40,40,40],"name":"330","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[340,340,340,340,340,340,340,340,340,340,340,340,340,340,340,340,340,340,340,340],"y":[10,13,15,18,21,24,27,29,31,33,37,38,40,40,40,40,40,40,40,40],"name":"340","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350,350],"y":[0,15,19,21,24,25,28,30,32,34,36,38,39,40,40,40,40,40,40,40],"name":"350","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[360,360,360,360,360,360,360,360,360,360,360,360,360,360,360,360,360,360,360,360],"y":[10,14,17,21,24,27,29,32,34,36,38,39,40,40,40,40,40,40,40,40],"name":"360","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[370,370,370,370,370,370,370,370,370,370,370,370,370,370,370,370,370,370,370,370],"y":[0,17,20,23,25,27,29,32,33,35,36,38,39,39,40,40,40,40,40,40],"name":"370","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[380,380,380,380,380,380,380,380,380,380,380,380,380,380,380,380,380,380,380,380],"y":[11,18,21,23,26,29,31,33,34,36,37,39,39,40,40,40,40,40,40,40],"name":"380","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390],"y":[11,19,22,26,28,31,33,35,36,37,39,40,40,40,40,40,40,40,40,40],"name":"390","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400,400],"y":[10,14,17,19,21,23,25,27,29,32,34,36,38,39,40,40,40,40,40,40],"name":"400","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[410,410,410,410,410,410,410,410,410,410,410,410,410,410,410,410,410,410,410,410],"y":[10,18,21,24,27,29,31,32,34,35,36,38,39,39,40,40,40,40,40,40],"name":"410","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[420,420,420,420,420,420,420,420,420,420,420,420,420,420,420,420,420,420,420,420],"y":[11,15,18,20,22,24,26,28,29,31,33,34,35,36,38,38,39,39,40,40],"name":"420","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[430,430,430,430,430,430,430,430,430,430,430,430,430,430,430,430,430,430,430,430],"y":[0,16,17,20,22,24,25,27,29,30,32,34,35,36,38,38,39,39,40,40],"name":"430","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[440,440,440,440,440,440,440,440,440,440,440,440,440,440,440,440,440,440,440,440],"y":[0,13,15,17,19,20,21,23,24,26,27,29,29,32,34,35,38,39,39,39],"name":"440","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450,450],"y":[0,13,14,16,18,19,21,22,23,25,26,29,29,32,35,35,35,35,36,40],"name":"450","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460],"y":[10,11,13,15,17,18,20,21,22,23,24,25,26,27,27,28,29,32,33,34],"name":"460","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470,470],"y":[0,13,17,18,20,22,22,24,26,27,27,29,32,32,34,35,35,35,35,38],"name":"470","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[480,480,480,480,480,480,480,480,480,480,480,480,480,480,480,480,480,480,480,480],"y":[10,17,20,22,24,26,28,29,30,31,32,35,35,35,35,35,35,35,39,40],"name":"480","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490],"y":[0,18,21,22,23,24,25,26,27,27,29,30,30,30,30,30,30,30,30,30],"name":"490","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[500,500,500,500,500,500,500,500,500,500,500,500,500,500,500,500,500,500,500,500],"y":[0,14,15,17,17,18,19,21,22,22,22,23,24,25,26,26,26,27,30,31],"name":"500","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[510,510,510,510,510,510,510,510,510,510,510,510,510,510,510,510,510,510,510,510],"y":[0,20,22,22,23,24,24,25,26,27,27,27,28,29,30,30,30,30,30,30],"name":"510","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[520,520,520,520,520,520,520,520,520,520,520,520,520,520,520,520,520,520,520,520],"y":[11,13,15,15,18,20,21,22,23,23,24,24,24,25,25,26,27,27,28,30],"name":"520","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530,530],"y":[18,21,21,22,23,24,24,25,25,25,26,27,27,27,30,30,30,30,30,30],"name":"530","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[540,540,540,540,540,540,540,540,540,540,540,540,540,540,540,540,540,540,540,540],"y":[13,13,14,17,17,17,18,18,19,22,24,24,24,27,27,30,30,30,30,30],"name":"540","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550,550],"y":[18,18,19,19,27,27,28,28,28,28,28,30,30,30,30,30,30,30,30,30],"name":"550","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[560,560,560,560,560,560,560,560,560,560,560,560,560,560,560,560,560,560,560,560],"y":[14,14,14,14,22,22,22,22,23,23,23,23,27,27,27,27,30,30,30,30],"name":"560","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[570,570,570,570,570,570,570,570,570,570,570,570,570,570,570,570,570,570,570,570],"y":[23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23],"name":"570","yaxis":"y","type":"box","marker":{"line":{"color":""},"opacity":0},"line":{"color":"rgb(0.1, 0.3, 0.9)"}},{"x":[0,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300,310,320,330,340,350,360,370,380,390,400,410,420,430,440,450,460,470,480,490,500,510,520,530,540,550,560,570],"y":[79862,79862,79862,79862,79862,79860,79837,79779,79750,79717,79558,79517,79478,79403,79356,79347,79336,79332,79312,79218,79202,79173,79157,79127,79114,79091,79086,79048,79015,78991,78961,78906,78828,78789,78712,78593,78416,78229,77965,77553,77014,76527,74876,73394,51546,48831,17942,16457,16020,15595,15131,13251,76,23,14,11,5,1],"name":"Coverage","yaxis":"y2","type":"scatter","marker":{"line":{"color":""},"opacity":1},"line":{"color":"rgb(0.2, 0.8, 0.1)"}}]`
  request.Kwargs = `{"filename": "plot from golang api",
        "fileopt": "overwrite",
        "world_readable": true,
        "layout":{
          "title":"Distribution of quality scores",
          "yaxis":{
            "title": "Quality score",
            "zeroline": true,
            "overlaying":false,
            "side":"left",
            "anchor":"x"
          },
          "yaxis2":{
            "title":"Counts",
            "overlaying":"y",
            "side":"right",
            "anchor":"x"
          },
          "xaxis":{
            "title":"Read position"
          },
          "showlegend":false
        }
  }`
  result, err := plotly.Post(request)
  fmt.Println(result)
  if err != nil {
    fmt.Println(err)
  } else {
    fmt.Printf("Succesfully create plot!\nFilename:%v\nURL:%v\n", result.Filename, result.Url)
  }
  result, err = plotly.Post(request)
  fmt.Println(result)
  fields := strings.Split(result.Url, "/")
  id := fields[4]
  response, err := plotly.Get(id)
  if err != nil {
    fmt.Println(err)
  } else {
    fmt.Println("Downloaded plot")
  }
  err = plotly.Download(response.Payload.Figure, "image.png")
  if err != nil {
    fmt.Println(err)
  }
}
